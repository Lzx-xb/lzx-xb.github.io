---
title: jenkins构建问题
date: 2023-09-13
icon: discover
category:
  - 部署
tag:
  - jenkins
footer: docker jenkins
---

## 部署问题

::: info 问题描述
    6.18剁手在腾讯云买了一台2核2G的服务器，用来学习一下docker，尝试一下jenkins的自动化构建。 
    在部署构建时，当构建到npm build步骤，服务器直接宕机，发现是内存爆表了。百度了一堆都没有解决到我的这个问题，升级服务器配置但又不划算。 
    在这卡很久了，所以记录一下问题。
:::

## 解决方案
1. 升级配置,价格翻倍（不想）
2. 添加虚拟内存(来自ChatGPT)

## 添加虚拟内存方法

1. **检查当前虚拟内存情况**：首先，您可以使用以下命令检查当前系统的虚拟内存情况：
``` linux
free -h
```
    这将显示已用和可用的内存以及交换空间的情况。请确保您的系统尚未使用交换空间，或者已使用的很少。 

2. **创建交换文件**：要创建4GB的交换文件，您可以执行以下命令：
``` bash
sudo fallocate -l 4G /swapfile   # 创建一个4GB的交换文件
sudo chmod 600 /swapfile         # 设置交换文件的权限
sudo mkswap /swapfile            # 将其标记为交换文件
sudo swapon /swapfile            # 启用交换文件
```
    这将创建一个4GB大小的交换文件并启用它。您可以根据需要调整文件大小。
3. **设置开机自启动**：为了确保交换文件在系统重启后仍然可用，您需要将其添加到 /etc/fstab 文件中：
``` bash
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
```

4. **验证虚拟内存配置**：您可以再次运行 `free -h` 命令来验证虚拟内存的配置，确保交换空间已经启用并且总可用内存增加到了4GB。

::: warning 温馨提示
请注意，虚拟内存可以帮助您在内存资源紧张时保持系统的稳定性，但它不应成为替代物理内存的解决方案。如果您的应用程序需要更多内存来运行，最好考虑升级服务器的物理内存，这将是提高性能的更可靠方法。
:::

实验成功后，记录结果，后续更新。
